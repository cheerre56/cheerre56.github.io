<!DOCTYPE html><html lang="zh-TW"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1.0"><title>CPK 智能數值生成器</title><style>:root{--primary:#2563eb;--primary-hover:#1d4ed8;--bg-gradient:linear-gradient(135deg,#f8fafc 0%,#e2e8f0 100%);--card-bg:#ffffff;--text-main:#0f172a;--text-secondary:#64748b;--border:#e2e8f0;--radius:12px;--success:#10b981}*{box-sizing:border-box;margin:0;padding:0}body{font-family:'Segoe UI','Microsoft JhengHei',sans-serif;background:var(--bg-gradient);color:var(--text-main);min-height:100vh;display:flex;justify-content:center;align-items:center;padding:2rem}.container{width:100%;max-width:950px;background:var(--card-bg);border-radius:var(--radius);box-shadow:0 10px 25px -5px rgba(0,0,0,0.1);overflow:hidden;display:grid;grid-template-columns:1fr 1fr;border:1px solid white}@media (max-width:768px){.container{grid-template-columns:1fr}}.panel-control{padding:2rem;border-right:1px solid var(--border);background:#fafafa;display:flex;flex-direction:column;gap:1.25rem}.panel-header h2{color:var(--primary);font-size:1.5rem;margin-bottom:0.5rem}.panel-header p{color:var(--text-secondary);font-size:0.9rem}.form-group label{display:block;font-size:0.85rem;font-weight:600;color:var(--text-secondary);margin-bottom:0.4rem}.input-row{display:grid;grid-template-columns:1fr 1fr;gap:12px}input{width:100%;padding:0.8rem;border:1px solid var(--border);border-radius:8px;font-size:0.95rem;transition:all 0.2s;background:white}input:focus{border-color:var(--primary);outline:none;box-shadow:0 0 0 3px rgba(37,99,235,0.1)}button.btn-generate{width:100%;padding:1rem;background:var(--primary);color:white;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;transition:background 0.2s;margin-top:2.5rem}button.btn-generate:hover{background:var(--primary-hover)}.panel-result{padding:2rem;display:flex;flex-direction:column;background:white;min-height:520px}.stats-card{background:#f1f5f9;border-radius:8px;padding:1rem;margin-bottom:1rem;border:1px solid var(--border);font-size:0.9rem}.stat-row{display:flex;justify-content:space-between;padding:4px 0;border-bottom:1px dashed #cbd5e1}.stat-row:last-child{border-bottom:none}.stat-label{color:var(--text-secondary)}.stat-val{font-family:monospace;font-weight:600;color:var(--text-main)}.stat-highlight .stat-val{color:var(--primary)}.result-wrapper{flex-grow:1;display:flex;flex-direction:column;border:1px solid var(--border);border-radius:8px;overflow:hidden}.result-header{display:flex;justify-content:space-between;align-items:center;padding:0.5rem 1rem;background:#f8fafc;border-bottom:1px solid var(--border)}.result-title{font-size:0.85rem;font-weight:600;color:var(--text-secondary)}.copy-btn{background:white;border:1px solid var(--border);padding:4px 12px;border-radius:4px;cursor:pointer;font-size:0.8rem;color:var(--text-main);transition:all 0.2s;display:flex;align-items:center;gap:5px}.copy-btn:hover{border-color:var(--primary);color:var(--primary)}.copy-btn.copied{background:var(--success);color:white;border-color:var(--success)}#resultText{width:100%;flex-grow:1;padding:1rem;border:none;resize:none;font-family:'Consolas','Monaco',monospace;font-size:0.95rem;line-height:1.6;color:var(--text-main);outline:none;background:white}.error-msg{color:#ef4444;font-size:0.85rem;text-align:center;margin-top:10px;min-height:20px}</style></head><body><div class="container"><div class="panel-control"><div class="panel-header"><h2>CPK 數值生成器</h2><p>輸入正負公差，自動模擬量測數據</p></div><form id="cpkForm"><div class="form-group"><label>規格中心值 (Standard)</label><input type="number" id="standard" step="any" required placeholder="例如：10.0"></div><div class="input-row"><div class="form-group"><label>正公差 (+)</label><input type="number" id="posTol" step="any" required placeholder="0.1"></div><div class="form-group"><label>負公差 (-)</label><input type="number" id="negTol" step="any" required placeholder="0.1"></div></div><div style="border-top:1px solid var(--border);margin:1rem 0"></div><div class="input-row"><div class="form-group"><label>目標 Cpk</label><input type="number" id="targetCpk" step="any" value="1.33" required></div><div class="form-group"><label>目標 Ca (%)</label><input type="number" id="targetCa" step="any" value="0" placeholder="0"></div></div><div class="input-row"><div class="form-group"><label>數據筆數 (N)</label><input type="number" id="n" value="32" min="5" required></div><div class="form-group"><label>小數位數</label><input type="number" id="decimal" value="3" min="0" max="6" required></div></div><button type="submit" class="btn-generate">生成數據</button><div id="errorMsg" class="error-msg"></div></form></div><div class="panel-result"><div id="statsBox" class="stats-card" style="display:none"></div><div class="result-wrapper"><div class="result-header"><span class="result-title">生成結果</span><button type="button" class="copy-btn" id="copyBtn" onclick="copyToClipboard()"><span>複製數據</span></button></div><textarea id="resultText" readonly placeholder="點擊左側按鈕生成數據..."></textarea></div></div></div><script>(()=>{const e=document.getElementById.bind(document),t=(t,n)=>{let o=0,r=0;for(;0===o;)o=Math.random();for(;0===r;)r=Math.random();return t+n*Math.sqrt(-2*Math.log(o))*Math.cos(2*Math.PI*r)},n=(e,t,n)=>{const o=e.reduce(((e,t)=>e+t),0)/e.length,r=Math.sqrt(e.reduce(((t,n)=>t+(n-o)**2),0)/(e.length-1)),a=t-n,l=(t+n)/2,c=(o-l)/(a/2),i=(t-o)/(3*r),s=(o-n)/(3*r);return{m:o,s:r,ca:100*c,cpk:Math.min(i,s)}},o=e("posTol"),r=e("negTol");let a=!1;r.addEventListener("input",(function(){this.value?a=!0:a=!1})),o.addEventListener("input",(function(){a||(r.value=this.value)})),e("cpkForm").addEventListener("submit"，(c=>{c.preventDefault();const i=e("errorMsg")，s=e("statsBox");i。textContent="";try{const c=parseFloat(e("standard")。value)，l=parseFloat(o。value)，u=parseFloat(r。value)，d=parseFloat(e("targetCpk")。value)，m=parseFloat(e("targetCa")。value)，p=parseInt(e("n")。value)，g=parseInt(e("decimal")。value);if(isNaN(c)||isNaN(l)||isNaN(u))throw new 错误("\u8ACB\u586B\u5BEB\u5B8C\u6574\u7684\u898F\u683C\u6578\u503C");if(l<0||u<0)throw new 错误("\u516C\u5DEE\u5FC5\u9808\u70BA\u6B63\u6578");const h=c+l，v=c-u,y=h-v，f=(h+v)/2，E=m/100，b=f+E*(y/2)，M=y*(1-Math。abs(E))/(6*d);if(M<=0)throw new 错误("\u76EE\u6A19\u8A2D\u5B9A\u4E0D\u5408\u7406");let x=[]，L=1/0，S={};for(let e=0;e<300;e++){const e=Array。from({length:p}，(()=>t(b，M)))，o=n(e，h，v)，r=Math。abs(o。cpk-d)*2+Math。abs(o。ca-m)/100;if(r<L&&(L=r，x=e，S=o)，Math。abs(o。cpk-d)<.005&&Math。abs(o。ca-m)<.2)break}e("resultText")。value=x。map((e=>e。toFixed(g)))。join("\n")，s。style。display="block"，s。innerHTML=`<div class="stat-row stat-highlight"><span class="stat-label">Cpk (\u76EE\u6A19/\u5BE6\u969B)</span><span class="stat-val">${d} / ${S。cpk。toFixed(3)}</span></div><div class="stat-row"><span class="stat-label">Ca (\u76EE\u6A19/\u5BE6\u969B)</span><span class="stat-val">${m}% / ${S。ca。toFixed(2)}%</span></div><div class="stat-row"><span class="stat-label">\u5E73\u5747\u503C Mean</span><span class="stat-val">${S。m。toFixed(g+1)}</span></div><div class="stat-row"><span class="stat-label">\u6A19\u6E96\u5DEE Sigma</span><span class="stat-val">${S。s。toFixed(g+2)}</span></div><div class="stat-row"><span class="stat-label">\u898F\u683C USL / LSL</span><span class="stat-val">${h} / ${v}</span></div>`}catch(e){i。textContent=e。message，s。style。display="none"}}))，window。copyToClipboard=function(){const t=e("resultText")，n=e("copyBtn");t。value&&(t。select()，navigator.clipboard。writeText(t。value)。键，然后((()=>{n。innerHTML="<span>\u5DF2\u8907\u88FD\uFF01</span>"，n。classList。add("copied")，setTimeout((()=>{n。innerHTML="<span>\u8907\u88FD\u6578\u64DA</span>"，n。classList.remove("copied")})，2e3)})))}})();</script></body></html>
