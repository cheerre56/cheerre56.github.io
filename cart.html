<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Selection | Naha Parfums</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Italiana&family=Space+Grotesk:wght@300;400&display=swap" rel="stylesheet">
    <style>
        /* ========================================= 
           CSS è®Šæ•¸å®šç¾© - é¡è‰²ä¸»é¡Œ
           ========================================= */
        :root {
            --bg-color: #050505;
            --card-bg: rgba(20, 20, 20, 0.6);
            --text-color: #e0e0e0;
            --accent-color: #888;
            --accent-gold: #c5a367;
            --border-radius: 12px;
        }

        /* ========================================= 
           å…¨å±€é‡ç½® - ç§»é™¤é è¨­é‚Šè·å’Œé‚Šæ¡†
           ========================================= */
        html, body {
            margin: 0; 
            padding: 0;
            width: 100%; 
            height: 100%;
            background-color: var(--bg-color);
            color: var(--text-color);
            font-family: 'Space Grotesk', sans-serif;
            overflow-x: hidden;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }

        /* ========================================= 
           èƒŒæ™¯æ¼¸å±¤å±¤ - å›ºå®šèƒŒæ™¯å…‰å½±
           ========================================= */
        .gradient-bg {
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh;
            z-index: -1; 
            pointer-events: none;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(70, 60, 150, 0.15), transparent 40%),
                radial-gradient(circle at 90% 80%, rgba(197, 163, 103, 0.1), transparent 40%);
            filter: blur(40px);
        }

        /* ========================================= 
           é ‚éƒ¨å°è¦½åˆ— - èœå–®å’Œè¿”å›é€£çµ
           ========================================= */
        nav {
            padding: 2rem 4rem;
            display: flex; 
            justify-content: space-between; 
            align-items: center;
        }
        
        .logo { 
            font-family: 'Italiana', serif; 
            font-size: 1.5rem; 
            letter-spacing: 2px; 
            color: white; 
            text-decoration: none;
            cursor: pointer;
            transition: opacity 0.3s ease;
        }

        .logo:hover {
            opacity: 0.7;
        }
        
        .back-link {
            font-size: 0.8rem; 
            letter-spacing: 1px; 
            color: var(--accent-color);
            text-decoration: none; 
            border-bottom: 1px solid transparent;
            transition: 0.3s;
        }
        
        .back-link:hover { 
            color: white; 
            border-bottom: 1px solid white; 
        }

        /* ========================================= 
           è³¼ç‰©è»Šä¸»å®¹å™¨ - å…©æ¬„ä½ˆå±€
           ========================================= */
        .cart-container {
            max-width: 1200px; 
            margin: 0 auto; 
            padding: 2rem 4rem;
            display: grid; 
            grid-template-columns: 2fr 1fr; 
            gap: 4rem;
            opacity: 0; 
            animation: fadeIn 0.8s ease-out forwards;
        }

        /* ========================================= 
           é é¢æ¨™é¡Œ - è·¨è¶Šå…¨è¡Œ
           ========================================= */
        h1.page-title {
            font-family: 'Italiana', serif; 
            font-size: 3rem; 
            color: white;
            margin-bottom: 2rem; 
            grid-column: 1 / -1;
            letter-spacing: 2px;
        }

        /* ========================================= 
           å·¦å´ï¼šå•†å“åˆ—è¡¨å®¹å™¨
           ========================================= */
        .cart-items { 
            display: flex; 
            flex-direction: column; 
            gap: 1.5rem; 
        }

        /* ========================================= 
           è³¼ç‰©è»Šå•†å“å¡ç‰‡
           ========================================= */
        .cart-item {
            display: flex; 
            align-items: center; 
            gap: 2rem;
            background: var(--card-bg);
            padding: 1.5rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(255,255,255,0.05);
            transition: transform 0.3s ease, border-color 0.3s ease;
        }
        
        .cart-item:hover { 
            transform: translateY(-2px); 
            border-color: rgba(255,255,255,0.15); 
        }

        /* ========================================= 
           å•†å“ç¸®åœ–
           ========================================= */
        .item-thumb {
            width: 80px; 
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            background: rgba(255,255,255,0.05);
            flex-shrink: 0;
        }

        /* ========================================= 
           å•†å“è³‡è¨Šå€ - åç¨±å’Œè¦æ ¼
           ========================================= */
        .item-info { 
            flex: 1; 
        }
        
        .item-name { 
            font-family: 'Italiana', serif; 
            font-size: 1.2rem; 
            margin-bottom: 0.3rem; 
            color: white;
            letter-spacing: 1px;
        }
        
        .item-variant { 
            font-size: 0.75rem; 
            color: var(--accent-color); 
            letter-spacing: 1px; 
            text-transform: uppercase;
        }

        /* ========================================= 
           å•†å“æ§åˆ¶å€ - æ•¸é‡ã€åƒ¹æ ¼ã€ç§»é™¤æŒ‰éˆ•
           ========================================= */
        .item-controls { 
            display: flex; 
            align-items: center; 
            gap: 2rem; 
        }
        
        /* ========================================= 
           æ•¸é‡é¸æ“‡å™¨
           ========================================= */
        .qty-selector {
            display: flex; 
            align-items: center; 
            gap: 1rem;
            border: 1px solid rgba(255,255,255,0.2);
            padding: 0.3rem 0.8rem; 
            border-radius: 20px;
        }
        
        .qty-btn { 
            background: none; 
            border: none; 
            color: white; 
            cursor: pointer; 
            font-size: 1rem;
            transition: color 0.3s ease;
        }

        .qty-btn:hover {
            color: var(--accent-gold);
        }
        
        .qty-val { 
            font-size: 0.9rem; 
            width: 20px; 
            text-align: center; 
        }

        /* ========================================= 
           å•†å“åƒ¹æ ¼
           ========================================= */
        .item-price { 
            font-family: 'Space Grotesk', sans-serif; 
            font-size: 1rem; 
            letter-spacing: 1px;
            min-width: 100px;
            text-align: right;
        }
        
        /* ========================================= 
           ç§»é™¤å•†å“æŒ‰éˆ•
           ========================================= */
        .remove-btn {
            background: none; 
            border: none; 
            color: var(--accent-color);
            cursor: pointer; 
            font-size: 1.2rem; 
            transition: color 0.3s ease;
        }
        
        .remove-btn:hover { 
            color: #ff6b6b; 
        }

        /* ========================================= 
           å³å´ï¼šçµå¸³æ‘˜è¦å¡ç‰‡
           ========================================= */
        .cart-summary {
            background: var(--card-bg);
            padding: 2rem;
            border-radius: var(--border-radius);
            border: 1px solid rgba(255,255,255,0.05);
            height: fit-content;
            position: sticky;
            top: 2rem;
        }

        /* ========================================= 
           æ‘˜è¦æ¨™é¡Œ
           ========================================= */
        .summary-title { 
            font-family: 'Italiana', serif; 
            font-size: 1.5rem; 
            margin-bottom: 1.5rem; 
            border-bottom: 1px solid rgba(255,255,255,0.1); 
            padding-bottom: 1rem;
            letter-spacing: 1px;
        }

        /* ========================================= 
           æ‘˜è¦åˆ—è¡¨è¡Œ - å°è¨ˆã€é‹è²»ç­‰
           ========================================= */
        .summary-row { 
            display: flex; 
            justify-content: space-between; 
            margin-bottom: 1rem; 
            font-size: 0.9rem; 
            color: var(--accent-color); 
        }
        
        .summary-row.total { 
            margin-top: 2rem; 
            margin-bottom: 2rem; 
            font-size: 1.2rem; 
            color: white; 
            font-weight: bold; 
            border-top: 1px solid rgba(255,255,255,0.1); 
            padding-top: 1rem;
            letter-spacing: 0.5px;
        }

        /* ========================================= 
           çµå¸³æŒ‰éˆ•
           ========================================= */
        .checkout-btn {
            width: 100%; 
            padding: 1rem;
            background-color: white; 
            color: black;
            border: none; 
            border-radius: 6px;
            font-family: 'Space Grotesk', sans-serif; 
            font-weight: bold;
            text-transform: uppercase; 
            letter-spacing: 2px;
            cursor: pointer; 
            transition: all 0.3s ease;
        }
        
        .checkout-btn:hover { 
            background-color: var(--accent-gold); 
            color: white;
            transform: scale(1.02);
        }

        .checkout-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: scale(1);
        }

        /* ========================================= 
           ç©ºè³¼ç‰©è»Šæç¤º
           ========================================= */
        .empty-cart-message {
            grid-column: 1 / -1;
            text-align: center;
            padding: 4rem 2rem;
            color: var(--accent-color);
        }

        .empty-cart-message h2 {
            font-family: 'Italiana', serif;
            font-size: 2rem;
            color: white;
            margin-bottom: 1rem;
        }

        /* ========================================= 
           è‡ªè¨‚è³¼è²·å½ˆçª—
           ========================================= */
        .checkout-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            backdrop-filter: blur(4px);
        }

        .checkout-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease-out;
        }

        .modal-content {
            background: linear-gradient(135deg, rgba(20, 20, 20, 0.95) 0%, rgba(30, 30, 30, 0.95) 100%);
            border: 1px solid rgba(197, 163, 103, 0.3);
            border-radius: 20px;
            padding: 3rem;
            max-width: 500px;
            width: 90%;
            text-align: center;
            position: relative;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.8);
            animation: slideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1);
        }

        /* ========================================= 
           å‹•ç•«å®šç¾©
           ========================================= */
        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        /* ========================================= 
           å½ˆçª—å…§å®¹æ¨£å¼
           ========================================= */
        .modal-icon {
            font-size: 4rem;
            margin-bottom: 1.5rem;
            animation: pulse 2s ease-in-out infinite;
        }

        .modal-title {
            font-family: 'Italiana', serif;
            font-size: 2.2rem;
            color: var(--accent-gold);
            margin-bottom: 1rem;
            letter-spacing: 2px;
        }

        .modal-subtitle {
            font-size: 1rem;
            color: white;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .modal-description {
            font-size: 0.9rem;
            color: var(--accent-color);
            margin-bottom: 2.5rem;
            line-height: 1.8;
            font-style: italic;
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .modal-btn {
            padding: 0.9rem 2rem;
            border: 1px solid var(--accent-gold);
            background: transparent;
            color: var(--accent-gold);
            font-size: 0.85rem;
            letter-spacing: 1.5px;
            text-transform: uppercase;
            cursor: pointer;
            border-radius: 6px;
            font-family: 'Space Grotesk', sans-serif;
            transition: all 0.3s ease;
        }

        .modal-btn:hover {
            background: var(--accent-gold);
            color: var(--bg-color);
            transform: scale(1.05);
        }

        .modal-btn.close-btn {
            border-color: var(--accent-color);
            color: var(--accent-color);
        }

        .modal-btn.close-btn:hover {
            background: var(--accent-color);
            color: white;
        }

        /* ========================================= 
           RWD å¹³æ¿è¨­å‚™é©é… (1024px ä»¥ä¸‹)
           ========================================= */
        @media (max-width: 1024px) {
            .cart-container {
                grid-template-columns: 1fr;
                padding: 2rem;
                gap: 2rem;
            }

            h1.page-title {
                font-size: 2.5rem;
            }

            .cart-summary {
                position: static;
            }

            .item-controls {
                flex-wrap: wrap;
                gap: 1rem;
            }

            .modal-content {
                padding: 2rem;
                max-width: 450px;
            }

            .modal-title {
                font-size: 1.8rem;
            }
        }

        /* ========================================= 
           RWD æ‰‹æ©Ÿè¨­å‚™é©é… (768px ä»¥ä¸‹)
           ========================================= */
        @media (max-width: 768px) {
            nav { 
                padding: 1.5rem 2rem; 
            }

            .cart-container { 
                grid-template-columns: 1fr; 
                padding: 1rem 1.5rem; 
                gap: 2rem; 
            }

            h1.page-title { 
                font-size: 1.8rem; 
            }
            
            .cart-item { 
                padding: 1rem; 
                gap: 1rem;
                flex-wrap: wrap;
            }

            .item-thumb { 
                width: 60px; 
                height: 60px; 
            }

            .item-name { 
                font-size: 1rem; 
            }

            .item-controls { 
                gap: 1rem;
                width: 100%;
                flex-wrap: wrap;
            }

            .qty-selector { 
                padding: 0.2rem 0.5rem; 
            }

            .item-price {
                min-width: auto;
            }

            .checkout-btn {
                padding: 0.8rem;
                font-size: 0.9rem;
            }

            .modal-content {
                padding: 1.5rem;
                max-width: 90%;
            }

            .modal-icon {
                font-size: 3rem;
            }

            .modal-title {
                font-size: 1.5rem;
            }

            .modal-subtitle {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>

    <!-- ========================================= 
         èƒŒæ™¯æ¼¸å±¤å±¤
         ========================================= -->
    <div class="gradient-bg"></div>

    <!-- ========================================= 
         è‡ªè¨‚è³¼è²·å½ˆçª—
         ========================================= -->
    <div class="checkout-modal" id="checkoutModal">
        <div class="modal-content">
            <div class="modal-icon">ğŸš§</div>
            <h2 class="modal-title">Coming Soon</h2>
            <p class="modal-subtitle">è³¼ç‰©æ”¯ä»˜ç³»çµ±æœªæ¥å…¥</p>
            <p class="modal-description">
                æ„Ÿè¬æ‚¨çš„æ”¯æŒï¼æˆ‘å€‘çš„æ”¯ä»˜ç³»çµ±æ­£åœ¨ç·Šå¯†é–‹ç™¼ä¸­ã€‚<br>
                å•†å“æš«æ™‚é‚„æ²’æº–å‚™å¥½ï¼Œæ•¬è«‹æœŸå¾…ï¼
            </p>
            <div class="modal-buttons">
                <button class="modal-btn" onclick="closeCheckoutModal()">è¿”å›è³¼ç‰©è»Š</button>
                <button class="modal-btn close-btn" onclick="goShopping()">ç¹¼çºŒè³¼ç‰©</button>
            </div>
        </div>
    </div>

    <!-- ========================================= 
         é ‚éƒ¨å°è¦½åˆ—
         ========================================= -->
    <nav>
        <a href="index.html" class="logo">naha.</a>
        <a href="chapter_luminescence.html" class="back-link">Continue Shopping</a>
    </nav>

    <!-- ========================================= 
         è³¼ç‰©è»Šä¸»å®¹å™¨
         ========================================= -->
    <div class="cart-container">
        <h1 class="page-title">Your Selection</h1>

        <!-- ========================================= 
             è³¼ç‰©è»Šå•†å“åˆ—è¡¨
             ========================================= -->
        <div class="cart-items" id="cartItems">
            <!-- å‹•æ…‹ç”Ÿæˆçš„å•†å“æœƒæ’å…¥åˆ°é€™è£¡ -->
        </div>

        <!-- ========================================= 
             çµå¸³æ‘˜è¦å¡ç‰‡
             ========================================= -->
        <div class="cart-summary">
            <h2 class="summary-title">Order Summary</h2>
            <div class="summary-row">
                <span>Subtotal</span>
                <span id="subtotal">NT$ 0</span>
            </div>
            <div class="summary-row">
                <span>Shipping</span>
                <span>Free</span>
            </div>
            <div class="summary-row total">
                <span>Total</span>
                <span id="total">NT$ 0</span>
            </div>
            <button class="checkout-btn" onclick="checkout()" id="checkoutBtn">Checkout</button>
        </div>
    </div>

    <script>
        /* ========================================= 
           æ¸…ç†èˆŠæ ¼å¼è³‡æ–™ - âœ… æ–°å¢
           ========================================= */
        function cleanOldCartData() {
            const cart = JSON.parse(localStorage.getItem('nahaCart')) || {};
            const validKeys = new Set([
                'Autumn Brew_10ml', 'Autumn Brew_30ml', 'Autumn Brew_50ml',
                'Forest Whispers_10ml', 'Forest Whispers_30ml', 'Forest Whispers_50ml'
            ]);

            let hasChanged = false;
            const newCart = {};

            Object.entries(cart).forEach(([key, value]) => {
                if (validKeys.has(key)) {
                    newCart[key] = value;
                } else {
                    // ç§»é™¤èˆŠæ ¼å¼æˆ–ç„¡æ•ˆçš„å•†å“
                    hasChanged = true;
                }
            });

            if (hasChanged) {
                localStorage.setItem('nahaCart', JSON.stringify(newCart));
            }

            return newCart;
        }

        /* ========================================= 
           è³¼ç‰©è»Šå•†å“è³‡æ–™åº«
           ========================================= */
        const cartData = {
            'Autumn Brew_10ml': { 
                name: 'Autumn Brew',
                price: 259, 
                img: 'https://i.meee.com.tw/mjeui9K.png', 
                variant: '10ml / Eau de Parfum' 
            },
            'Autumn Brew_30ml': { 
                name: 'Autumn Brew',
                price: 495, 
                img: 'https://i.meee.com.tw/mjeui9K.png', 
                variant: '30ml / Eau de Parfum' 
            },
            'Autumn Brew_50ml': { 
                name: 'Autumn Brew',
                price: 765, 
                img: 'https://i.meee.com.tw/mjeui9K.png', 
                variant: '50ml / Eau de Parfum' 
            },
            'Forest Whispers_10ml': { 
                name: 'Forest Whispers',
                price: 259, 
                img: 'https://i.meee.com.tw/mjeui9K.png', 
                variant: '10ml / Eau de Parfum' 
            },
            'Forest Whispers_30ml': { 
                name: 'Forest Whispers',
                price: 495, 
                img: 'https://i.meee.com.tw/mjeui9K.png', 
                variant: '30ml / Eau de Parfum' 
            },
            'Forest Whispers_50ml': { 
                name: 'Forest Whispers',
                price: 765, 
                img: 'https://i.meee.com.tw/mjeui9K.png', 
                variant: '50ml / Eau de Parfum' 
            }
        };

        /* ========================================= 
           å¾ LocalStorage è®€å–è³¼ç‰©è»Šå…§å®¹
           ========================================= */
        function loadCart() {
            return cleanOldCartData();
        }

        /* ========================================= 
           æ¸²æŸ“è³¼ç‰©è»Šå•†å“
           ========================================= */
        function renderCart() {
            const cart = loadCart();
            const cartItems = document.getElementById('cartItems');
            cartItems.innerHTML = '';

            if (Object.keys(cart).length === 0) {
                cartItems.parentElement.innerHTML = `
                    <div class="empty-cart-message">
                        <h2>Your cart is empty</h2>
                        <p>Add some fragrances to get started.</p>
                    </div>
                `;
                document.getElementById('subtotal').innerText = 'NT$ 0';
                document.getElementById('total').innerText = 'NT$ 0';
                document.getElementById('checkoutBtn').disabled = true;
                return;
            }

            document.getElementById('checkoutBtn').disabled = false;

            Object.entries(cart).forEach(([key, item]) => {
                const product = cartData[key];
                
                if (!product) return;

                const quantity = item.quantity || item;
                const price = product.price;
                const itemTotal = price * quantity;
                const itemElement = document.createElement('div');
                itemElement.className = 'cart-item';
                itemElement.dataset.key = key;
                itemElement.dataset.price = price;

                itemElement.innerHTML = `
                    <img src="${product.img}" alt="${product.name}" class="item-thumb">
                    <div class="item-info">
                        <div class="item-name">${product.name}</div>
                        <div class="item-variant">${product.variant}</div>
                    </div>
                    <div class="item-controls">
                        <div class="qty-selector">
                            <button class="qty-btn minus">âˆ’</button>
                            <span class="qty-val">${quantity}</span>
                            <button class="qty-btn plus">+</button>
                        </div>
                        <div class="item-price">NT$ ${itemTotal.toLocaleString()}</div>
                        <button class="remove-btn">Ã—</button>
                    </div>
                `;

                const minusBtn = itemElement.querySelector('.minus');
                const plusBtn = itemElement.querySelector('.plus');
                const removeBtn = itemElement.querySelector('.remove-btn');

                minusBtn.addEventListener('click', () => updateQuantity(key, quantity - 1));
                plusBtn.addEventListener('click', () => updateQuantity(key, quantity + 1));
                removeBtn.addEventListener('click', () => removeItem(key));

                cartItems.appendChild(itemElement);
            });

            updateTotal();
        }

        /* ========================================= 
           æ›´æ–°å•†å“æ•¸é‡
           ========================================= */
        function updateQuantity(key, quantity) {
            const cart = loadCart();
            if (quantity <= 0) {
                delete cart[key];
            } else {
                const item = cart[key];
                if (typeof item === 'object') {
                    item.quantity = quantity;
                } else {
                    cart[key] = quantity;
                }
            }
            localStorage.setItem('nahaCart', JSON.stringify(cart));
            renderCart();
        }

        /* ========================================= 
           ç§»é™¤å•†å“
           ========================================= */
        function removeItem(key) {
            const cart = loadCart();
            delete cart[key];
            localStorage.setItem('nahaCart', JSON.stringify(cart));
            renderCart();
        }

        /* ========================================= 
           æ›´æ–°ç¸½åƒ¹
           ========================================= */
        function updateTotal() {
            const cart = loadCart();
            let total = 0;

            Object.entries(cart).forEach(([key, item]) => {
                const product = cartData[key];
                const quantity = item.quantity || item;
                if (product) {
                    total += product.price * quantity;
                }
            });

            const formattedTotal = 'NT$ ' + total.toLocaleString();
            document.getElementById('subtotal').innerText = formattedTotal;
            document.getElementById('total').innerText = formattedTotal;
        }

        /* ========================================= 
           çµå¸³å‡½å¼
           ========================================= */
        function checkout() {
            const cart = loadCart();
            if (Object.keys(cart).length === 0) {
                return;
            }
            openCheckoutModal();
        }

        /* ========================================= 
           æ‰“é–‹è³¼è²·å½ˆçª—
           ========================================= */
        function openCheckoutModal() {
            const modal = document.getElementById('checkoutModal');
            modal.classList.add('active');
        }

        /* ========================================= 
           é—œé–‰è³¼è²·å½ˆçª—
           ========================================= */
        function closeCheckoutModal() {
            const modal = document.getElementById('checkoutModal');
            modal.classList.remove('active');
        }

        /* ========================================= 
           ç¹¼çºŒè³¼ç‰©
           ========================================= */
        function goShopping() {
            window.location.href = 'chapter_luminescence.html';
        }

        /* ========================================= 
           é»æ“Šå½ˆçª—å¤–éƒ¨é—œé–‰
           ========================================= */
        document.getElementById('checkoutModal').addEventListener('click', (e) => {
            if (e.target.id === 'checkoutModal') {
                closeCheckoutModal();
            }
        });

        /* ========================================= 
           é é¢è¼‰å…¥æ™‚æ¸²æŸ“è³¼ç‰©è»Šä¸¦æ¸…ç†èˆŠè³‡æ–™
           ========================================= */
        document.addEventListener('DOMContentLoaded', () => {
            renderCart();
        });
    </script>
</body>
</html>
