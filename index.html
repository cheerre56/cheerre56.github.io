<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Naha Parfums | Beyond Scents</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Italiana&family=Space+Grotesk:wght@300;400&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300&display=swap" rel="stylesheet">
    <style>
        /* ========================================= 
           CSS 變數定義
           ========================================= */
        :root {
            --bg-color: #050505;
            --text-color: #e0e0e0;
            --text-sub: #a0a0a0;
            --accent-color: #888;
            --accent-gold: #c5a367;
            --line-width: 25px;
            --line-left-pos: -80%;
            --line-right-pos: -80%;
            --glass-border: rgba(255, 255, 255, 0.1);
        }

        /* ========================================= 
           全局重置
           ========================================= */
        html, body {
            margin: 0; padding: 0; border: 0;
            width: 100%; height: 100%;
            background-color: transparent; 
            overflow: hidden;
            overscroll-behavior: none;
        }

        *, *::before, *::after {
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            margin: 0; padding: 0; border: 0;
        }

        body {
            color: var(--text-color);
            font-family: 'Space Grotesk', sans-serif;
            -webkit-font-smoothing: antialiased;
            opacity: 0; 
            transition: opacity 1.0s ease-out;
        }
        body.loaded { opacity: 1; }

        /* ========================================= 
           背景特效
           ========================================= */
        .gradient-bg {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            z-index: -1;
            background-color: var(--bg-color); 
            background-image: 
                radial-gradient(circle at 20% 40%, rgba(70, 60, 150, 0.35), transparent 45%),
                radial-gradient(circle at 80% 60%, rgba(40, 120, 110, 0.3), transparent 45%);
            filter: blur(1px);
            will-change: filter;
        }

        /* ========================================= 
           核心滾動容器 (Outer Scroll)
           ========================================= */
        .main-scroll-container {
            height: 100vh; height: 100dvh; width: 100vw;
            overflow-y: scroll;
            scroll-snap-type: y mandatory;
            scroll-behavior: smooth;
            -ms-overflow-style: none; scrollbar-width: none;
        }
        .main-scroll-container::-webkit-scrollbar { display: none; }

        /* ========================================= 
           Section 通用設置
           ========================================= */
        section {
            width: 100vw; height: 100vh; height: 100dvh;
            position: relative; overflow: hidden;
            display: flex; flex-direction: column;
            justify-content: center; align-items: center;
            scroll-snap-align: start; scroll-snap-stop: always;
        }

        /* ========================================= 
           導覽列
           ========================================= */
        nav {
            position: fixed; top: 0; width: 100%; padding: 2.5rem 4rem;
            display: flex; justify-content: space-between; align-items: center;
            z-index: 100; mix-blend-mode: difference; pointer-events: none;
        }
        .logo { 
            font-family: 'Italiana', serif; font-size: 1.5rem; letter-spacing: 2px; 
            color: white; pointer-events: auto; cursor: pointer;
        }
        .est { font-size: 0.7rem; letter-spacing: 1px; opacity: 0.6; color: white; }

        /* ========================================= 
           第一頁：Hero Styles
           ========================================= */
        .hero-title-wrapper { position: relative; display: inline-block; }
        .hero-title {
            font-size: 13vw; font-family: 'Italiana', serif; line-height: 0.85;
            opacity: 0; transform: translateY(30px);
            animation: fadeUp 1.5s cubic-bezier(0.16, 1, 0.3, 1) forwards 0.5s;
            text-align: center; pointer-events: auto;
            text-shadow: 0 10px 30px rgba(0,0,0,0.3); position: relative; z-index: 2;
        }
        .hero-title::before, .hero-title::after {
            content: ''; position: absolute; top: 50%; width: var(--line-width); height: 0%;
            background: var(--accent-gold); will-change: height, width, left, right; z-index: -1;
        }
        .hero-title::before {
            left: 50%; transform: translate(-50%, -50%);
            animation: growCenterLine 1.2s cubic-bezier(0.16, 1, 0.3, 1) forwards 0.8s,
                       splitLineLeft 2s cubic-bezier(0.16, 1, 0.3, 1) forwards 1.8s;
        }
        .hero-title::after {
            right: 50%; transform: translate(50%, -50%);
            animation: growCenterLine 1.2s cubic-bezier(0.16, 1, 0.3, 1) forwards 0.8s,
                       splitLineRight 2s cubic-bezier(0.16, 1, 0.3, 1) forwards 1.8s;
        }
        .hero-subtitle {
            margin-top: 1.5rem; font-size: 0.9rem; color: var(--accent-color);
            letter-spacing: 0.4em; text-transform: uppercase;
            opacity: 0; transform: translateY(30px);
            animation: fadeUp 1.5s cubic-bezier(0.16, 1, 0.3, 1) forwards 0.7s;
        }
        .scroll-hint {
            position: absolute; bottom: 4rem; display: flex; flex-direction: column;
            align-items: center; gap: 10px; opacity: 0; 
            animation: fadeUp 1.5s cubic-bezier(0.16, 1, 0.3, 1) forwards 1.2s; pointer-events: auto;
        }
        .scroll-text { font-size: 0.7rem; letter-spacing: 3px; text-transform: uppercase; color: rgba(255,255,255,0.5); }
        .scroll-line {
            width: 1px; height: 40px; background: rgba(255,255,255,0.3);
            animation: growLine 2s infinite ease-in-out; transform-origin: top;
        }

        /* ========================================= 
           第二頁：Collection Styles
           ========================================= */
        .collection-section { flex-direction: row; background-color: transparent; }
        .chapter {
            flex: 1; height: 100%; position: relative;
            border-right: 1px solid rgba(255,255,255,0.1);
            transition: flex 0.8s cubic-bezier(0.25, 1, 0.5, 1);
            overflow: hidden; pointer-events: auto; cursor: pointer;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background-color: rgba(5, 5, 5, 0.5); backdrop-filter: blur(3px);
        }
        .chapter:last-child { border-right: none; }
        .chapter:hover { flex: 2.5; }
        .collection-section:hover .chapter:not(:hover) { opacity: 0.4; }
        
        .bg-video {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            object-fit: cover; opacity: 0.5; transition: opacity 0.8s ease, filter 0.8s ease;
            filter: saturate(0.2) brightness(0.6); z-index: 0;
        }
        .chapter:hover .bg-video { opacity: 1; filter: saturate(1) brightness(1); }
        
        .content {
            text-align: center; z-index: 2; position: relative;
            transform: translateY(20px); transition: transform 0.6s ease 0.1s;
        }
        .chapter:hover .content { transform: translateY(0); }
        
        .ch-num { font-family: 'Italiana', serif; font-size: 0.9rem; letter-spacing: 3px; color: var(--accent-gold); margin-bottom: 1rem; display: block; opacity: 0.9; }
        .ch-title { font-family: 'Italiana', serif; font-size: 3.5vw; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 0.5rem; white-space: nowrap; color: white; text-shadow: 0 10px 30px rgba(0,0,0,0.8); }
        .ch-desc { 
            font-size: 0.75rem; letter-spacing: 0.3em; text-transform: uppercase; 
            opacity: 0; transform: translateY(20px); transition: all 0.6s ease 0.1s; color: rgba(255,255,255,0.8); 
        }
        .chapter:hover .ch-desc { opacity: 1; transform: translateY(0); }
        .chapter::after {
            content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(to bottom, rgba(0,0,0,0.2), rgba(0,0,0,0.8)); z-index: 1; pointer-events: none;
        }

        /* ========================================= 
           第三頁：Knowledge (FAQ) Styles - ✅ 修正版
           ========================================= */
        .knowledge-section {
            display: block; 
            padding: 0;
        }

        .knowledge-scroll-wrapper {
            width: 100%; height: 100%;
            overflow-y: scroll; 
            /* ✅ 修正重點 1：父容器 Padding 設為 0，避免推擠 sticky 元素 */
            padding: 0; 
            display: flex; 
            /* 讓左右內容自己控制間距 */
            max-width: 1400px; 
            margin: 0 auto;
            position: relative;
            -ms-overflow-style: none; scrollbar-width: none;
        }
        .knowledge-scroll-wrapper::-webkit-scrollbar { display: none; }

        /* 左側索引 - ✅ 修正版 */
        .visual-area {
            flex: 0 0 35%;
            /* ✅ 修正重點 2：高度設為 100vh，直接對齊螢幕 */
            height: 100vh;
            /* ✅ 修正重點 3：Top 設為 0，無任何邊距干擾 */
            position: sticky;
            top: 0;
            display: flex; 
            flex-direction: column; 
            justify-content: center; /* 這會確保它在 100vh 的中間 */
            
            /* 將原本父層的左邊距補回來 */
            padding-left: 5%; 
        }

        .visual-orb {
            position: absolute; top: 50%; left: 20%; transform: translate(-50%, -50%);
            width: 300px; height: 300px;
            background: radial-gradient(circle, rgba(197, 163, 103, 0.15), transparent 70%);
            filter: blur(40px); border-radius: 50%; z-index: -1;
            animation: orbFloat 6s ease-in-out infinite;
        }

        .index-content { position: relative; z-index: 1; }
        .big-number {
            font-family: 'Italiana', serif; font-size: 12rem; line-height: 0.8;
            color: rgba(255, 255, 255, 0.03); position: absolute; top: -60px; left: -20px;
            z-index: -1; transition: all 0.5s ease;
        }
        .chapter-label { font-size: 0.75rem; letter-spacing: 4px; text-transform: uppercase; color: var(--accent-gold); margin-bottom: 1rem; display: block; opacity: 0; transform: translateY(20px); }
        .chapter-title { font-family: 'Italiana', serif; font-size: 3.5rem; color: white; line-height: 1.1; margin-bottom: 1.5rem; opacity: 0; transform: translateY(20px); }
        .chapter-desc { 
            font-family: 'Noto Sans TC', sans-serif; font-size: 0.9rem; color: var(--text-sub); 
            line-height: 1.8; max-width: 300px; border-left: 1px solid var(--accent-gold); 
            padding-left: 1.5rem; opacity: 0; transform: translateY(20px); 
        }

        .knowledge-section.visible .chapter-label { animation: fadeUp 0.8s forwards; }
        .knowledge-section.visible .chapter-title { animation: fadeUp 0.8s forwards 0.2s; }
        .knowledge-section.visible .chapter-desc { animation: fadeUp 0.8s forwards 0.4s; }

        /* 右側內容 - ✅ 修正版 */
        .content-area { 
            flex: 1; 
            pointer-events: auto;
            /* ✅ 修正重點 4：將原本父層的 Padding 移到這裡 */
            padding-top: 180px; /* 避開 Nav */
            padding-right: 5%; /* 補回右邊距 */
            padding-bottom: 100px;
            /* 增加左邊距，與左側區塊分開 */
            margin-left: 8%;
        }
        
        .faq-group {
            margin-bottom: 25vh; /* 增加間距確保滾動順暢 */
            opacity: 0.3; transition: opacity 0.6s ease, filter 0.6s ease; filter: blur(3px);
        }
        .faq-group.active { opacity: 1; filter: blur(0); }
        .faq-group:last-child { margin-bottom: 0; }

        .group-header {
            border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 1rem;
            margin-bottom: 2rem; display: flex; align-items: baseline; gap: 1rem;
        }
        .group-num { font-family: 'Italiana', serif; font-size: 1.5rem; color: var(--accent-gold); }
        .group-title { font-size: 0.9rem; letter-spacing: 2px; text-transform: uppercase; color: var(--text-sub); }

        .faq-item { border-bottom: 1px solid rgba(255, 255, 255, 0.05); margin-bottom: 0; }
        .faq-question {
            padding: 1.5rem 0; cursor: pointer; display: flex; justify-content: space-between;
            align-items: center; font-size: 1.1rem; color: white; transition: color 0.3s;
        }
        .faq-question:hover { color: var(--accent-gold); }
        
        .icon-plus { position: relative; width: 12px; height: 12px; }
        .icon-plus::before, .icon-plus::after {
            content: ''; position: absolute; background: var(--accent-gold);
            top: 50%; left: 50%; transform: translate(-50%, -50%); transition: all 0.3s;
        }
        .icon-plus::before { width: 100%; height: 1px; }
        .icon-plus::after { width: 1px; height: 100%; }
        .faq-item.active .icon-plus::after { height: 0; }
        .faq-item.active .icon-plus::before { transform: translate(-50%, -50%) rotate(180deg); }

        .faq-answer { max-height: 0; overflow: hidden; transition: max-height 0.5s cubic-bezier(0.25, 1, 0.5, 1); }
        .faq-content { padding-bottom: 1.5rem; color: var(--text-sub); font-family: 'Noto Sans TC', sans-serif; font-size: 0.95rem; line-height: 1.8; font-weight: 300; }
        .faq-item.active .faq-answer { max-height: 300px; }

        .knowledge-footer { margin-top: 5rem; text-align: center; font-size: 0.8rem; color: var(--text-sub); opacity: 0.6; padding-bottom: 2rem;}

        /* ========================================= 
           動畫 Keyframes
           ========================================= */
        @keyframes fadeUp { to { opacity: 1; transform: translateY(0); } }
        @keyframes growCenterLine { 0% { height: 0%; width: var(--line-width); opacity: 1; } 100% { height: 100%; width: var(--line-width); opacity: 1; } }
        @keyframes splitLineLeft { 0% { width: var(--line-width); left: 50%; opacity: 1; } 100% { width: 2px; left: var(--line-left-pos); opacity: 0.7; } }
        @keyframes splitLineRight { 0% { width: var(--line-width); right: 50%; opacity: 1; } 100% { width: 2px; right: var(--line-right-pos); opacity: 0.7; } }
        @keyframes growLine { 0% { transform: scaleY(0); transform-origin: top; opacity: 0; } 50% { transform: scaleY(1); transform-origin: top; opacity: 1; } 51% { transform: scaleY(1); transform-origin: bottom; opacity: 1; } 100% { transform: scaleY(0); transform-origin: bottom; opacity: 0; } }
        @keyframes orbFloat { 0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.8; } 50% { transform: translate(-50%, -60%) scale(1.1); opacity: 1; } }

        /* ========================================= 
           過渡層
           ========================================= */
        .transition-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background-color: #000; opacity: 0; visibility: hidden;
            transition: opacity 0.8s ease; z-index: 9999;
        }
        .transition-overlay.active { opacity: 1; visibility: visible; }

        /* ========================================= 
           RWD 適配 (手機)
           ========================================= */
        @media (max-width: 768px) {
            :root { --line-width: 15px; --line-left-pos: -50%; --line-right-pos: -50%; }
            nav { padding: 1.5rem 2rem; }
            .hero-title { font-size: 20vw; }
            .collection-section { flex-direction: column; }
            .chapter { width: 100%; flex: 1 !important; border-right: none; border-bottom: 1px solid rgba(255,255,255,0.1); }
            .ch-title { font-size: 1.8rem; } .ch-desc { opacity: 0.7; transform: translateY(0); margin-top: 2px; } .content { transform: translateY(0); }
            .bg-overlay, .bg-video { opacity: 0.6; }

            /* Knowledge Section Mobile - ✅ 修正版 */
            .knowledge-scroll-wrapper { 
                flex-direction: column; 
                padding: 100px 5% 40px; /* 手機版還是需要 Padding */
                gap: 3rem; 
            }
            .visual-area { 
                /* 重置 Desktop 的特殊定位 */
                position: relative; top: 0; height: auto; 
                margin-top: 0; padding-top: 0; padding-left: 0;
                flex: none; align-items: center; text-align: center; margin-bottom: 2rem; 
            }
            .content-area {
                padding-top: 0; padding-right: 0; margin-left: 0;
            }
            
            .visual-orb { left: 50%; width: 200px; height: 200px; }
            .big-number { font-size: 8rem; top: -30px; left: 50%; transform: translateX(-50%); }
            .chapter-desc { border-left: none; padding-left: 0; margin: 0 auto; }
            .faq-group { opacity: 1; filter: blur(0); margin-bottom: 3rem; }
            .faq-question { font-size: 1rem; }
        }
    </style>
</head>
<body>

    <div class="gradient-bg"></div>
    <div class="transition-overlay" id="overlay"></div>

    <nav>
        <div class="logo" onclick="window.scrollTo({top:0, behavior:'smooth'})">naha.</div>
        <div class="est">EST. 2026</div>
    </nav>

    <div class="main-scroll-container">
        
        <section class="hero-section">
            <div class="hero-title-wrapper">
                <h1 class="hero-title">NAHA</h1>
            </div>
            <p class="hero-subtitle">Parfums - Beyond Scents</p>
            <div class="scroll-hint">
                <span class="scroll-text">Scroll</span>
                <div class="scroll-line"></div>
            </div>
        </section>

        <section class="collection-section">
            <div class="chapter c1" onclick="navigateTo('chapter_luminescence.html')" onmouseenter="playVideo(this)" onmouseleave="pauseVideo(this)">
                <video class="bg-video" playsinline muted loop><source src="flower.mp4" type="video/mp4"></video>
                <div class="content"><span class="ch-num">Chapter I</span><h2 class="ch-title">Luminescence</h2><p class="ch-desc">The Floral Series</p></div>
            </div>
            <div class="chapter c2" onclick="navigateTo('chapter_silhouette.html')" onmouseenter="playVideo(this)" onmouseleave="pauseVideo(this)">
                <video class="bg-video" playsinline muted loop><source src="Wood.mp4" type="video/mp4"></video>
                <div class="content"><span class="ch-num">Chapter II</span><h2 class="ch-title">Silhouette</h2><p class="ch-desc">The Woody Series</p></div>
            </div>
            <div class="chapter c3" onclick="navigateTo('chapter_obsidian.html')" onmouseenter="playVideo(this)" onmouseleave="pauseVideo(this)">
                <video class="bg-video" playsinline muted loop><source src="Orient.mp4" type="video/mp4"></video>
                <div class="content"><span class="ch-num">Chapter III</span><h2 class="ch-title">Obsidian</h2><p class="ch-desc">The Oriental Series</p></div>
            </div>
        </section>

        <section class="knowledge-section" id="knowledgeSection">
            <div class="knowledge-scroll-wrapper" id="knowledgeScroll">
                
                <div class="visual-area">
                    <div class="visual-orb"></div>
                    <div class="index-content">
                        <div class="big-number" id="visualNum">01</div>
                        <span class="chapter-label" id="visualLabel">CHAPTER 01</span>
                        <h2 class="chapter-title" id="visualTitle">Selection</h2>
                        <p class="chapter-desc" id="visualDesc">
                            香水是記憶的載體。挑選一款適合的香氛，不僅是嗅覺的體驗，更是一場尋找自我印記的旅程。
                        </p>
                    </div>
                </div>

                <div class="content-area">
                    <div class="faq-group active" id="group1">
                        <div class="group-header"><span class="group-num">01.</span><span class="group-title">Selection / 挑選與體驗</span></div>
                        <div class="faq-item"><div class="faq-question">剛噴出來的味道有點刺鼻？<div class="icon-plus"></div></div><div class="faq-answer"><div class="faq-content">這是正常的。香水含高比例酒精，剛噴出時酒精正快速揮發。建議靜待 30 秒至 1 分鐘，避開前味酒精感，再細細品味層次。</div></div></div>
                        <div class="faq-item"><div class="faq-question">如何找到適合自己的香水？<div class="icon-plus"></div></div><div class="faq-answer"><div class="faq-content">從「場景」與「記憶」入手。工作適合乾淨木質調；約會適合溫柔花香。建議購買試香組，在手腕試噴並感受 4-6 小時的完整變化。</div></div></div>
                        <div class="faq-item"><div class="faq-question">EDP 與 EDT 的濃度區別？<div class="icon-plus"></div></div><div class="faq-answer"><div class="faq-content">EDP (Eau de Parfum) 濃度 15-20%，持香 5-8 小時，層次豐富；EDT (Eau de Toilette) 濃度 5-15%，持香 3-4 小時，氣味較輕盈。</div></div></div>
                    </div>

                    <div class="faq-group" id="group2">
                        <div class="group-header"><span class="group-num">02.</span><span class="group-title">Rituals / 穿香技巧</span></div>
                        <div class="faq-item"><div class="faq-question">為什麼留香時間很短？<div class="icon-plus"></div></div><div class="faq-answer"><div class="faq-content">留香受濃度、濕度及體溫影響。皮膚乾燥易揮發，建議先塗無香乳液保濕。此外，長期使用同款香水會產生「嗅覺疲勞」，導致自己聞不到。</div></div></div>
                        <div class="faq-item"><div class="faq-question">噴完香水可以摩擦手腕嗎？<div class="icon-plus"></div></div><div class="faq-answer"><div class="faq-content">請避免！摩擦產生的熱能會破壞香水前調分子結構，導致氣味變質。正確方式是輕點手腕，讓其自然乾燥。</div></div></div>
                    </div>

                    <div class="faq-group" id="group3">
                        <div class="group-header"><span class="group-num">03.</span><span class="group-title">Care / 保存與維護</span></div>
                        <div class="faq-item"><div class="faq-question">香水會過期嗎？<div class="icon-plus"></div></div><div class="faq-answer"><div class="faq-content">若保存得當（避光、陰涼），香水可存放多年。請避開陽光直射、高溫與浴室潮濕環境。理想溫度為 15-25°C。</div></div></div>
                        <div class="faq-item"><div class="faq-question">顏色變深正常嗎？<div class="icon-plus"></div></div><div class="faq-answer"><div class="faq-content">是的。許多天然香材（如香草、茉莉）會隨時間氧化使液體變深，這通常是天然成分的證明，不影響氣味品質。</div></div></div>
                    </div>

                    <div class="knowledge-footer">&copy; 2026 Naha Parfums.</div>
                </div>
            </div>
        </section>

    </div>

    <script>
        const isMobile = window.innerWidth <= 768;

        /* ========================================= 
           初始化
           ========================================= */
        window.addEventListener('load', () => {
            document.body.classList.add('loaded');
            if (isMobile) initializeMobileVideos();
        });

        /* ========================================= 
           導航與影片邏輯
           ========================================= */
        window.addEventListener('pageshow', (event) => {
            const overlay = document.getElementById('overlay');
            if (overlay) { overlay.classList.remove('active'); overlay.style.opacity = '0'; overlay.style.visibility = 'hidden'; }
            document.body.style.display = 'block'; document.body.style.opacity = '1';
            if (isMobile) initializeMobileVideos();
        });

        function initializeMobileVideos() {
            document.querySelectorAll('.bg-video').forEach(video => {
                const chapter = video.closest('.chapter');
                video.playbackRate = (chapter.classList.contains('c1') || chapter.classList.contains('c3')) ? 0.5 : 0.8;
                video.play().catch(err => console.log('Autoplay blocked', err));
            });
        }

        function playVideo(el) { if (!isMobile) el.querySelector('.bg-video')?.play().catch(() => {}); }
        function pauseVideo(el) { 
            if (!isMobile) { 
                const v = el.querySelector('.bg-video'); 
                if (v) { v.pause(); v.currentTime = 0; } 
            } 
        }

        function navigateTo(url) {
            if(!url) return;
            document.getElementById('overlay').classList.add('active');
            setTimeout(() => window.location.href = url, 800);
        }

        /* ========================================= 
           FAQ 邏輯 (整合版)
           ========================================= */
        
        // 1. Intersection Observer for Knowledge Section Animation
        const knowledgeSection = document.getElementById('knowledgeSection');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) knowledgeSection.classList.add('visible');
            });
        }, { threshold: 0.3 });
        observer.observe(knowledgeSection);

        // 2. Accordion Logic
        document.querySelectorAll('.faq-question').forEach(q => {
            q.addEventListener('click', (e) => {
                e.stopPropagation();
                const item = q.parentElement;
                const isActive = item.classList.contains('active');
                item.closest('.faq-group').querySelectorAll('.faq-item').forEach(i => i.classList.remove('active'));
                if(!isActive) item.classList.add('active');
            });
        });

        // 3. Scroll Spy for Knowledge Section (Internal Scroll)
        const knowledgeScroll = document.getElementById('knowledgeScroll');
        const groups = document.querySelectorAll('.faq-group');
        const visualNum = document.getElementById('visualNum');
        const visualLabel = document.getElementById('visualLabel');
        const visualTitle = document.getElementById('visualTitle');
        const visualDesc = document.getElementById('visualDesc');

        const contentData = [
            { num: '01', label: 'CHAPTER 01', title: 'Selection', desc: '香水是記憶的載體。挑選一款適合的香氛，不僅是嗅覺的體驗，更是一場尋找自我印記的旅程。' },
            { num: '02', label: 'CHAPTER 02', title: 'Rituals', desc: '穿香是一種儀式。掌握溫度與脈搏的秘密，讓香氣成為你無形的第二層肌膚，如影隨形。' },
            { num: '03', label: 'CHAPTER 03', title: 'Care', desc: '時間是香氛的朋友，也是敵人。學會正確的收藏與養護，讓每一瓶香水都能陪你走過漫長歲月。' }
        ];

        knowledgeScroll.addEventListener('scroll', () => {
            let currentGroupIndex = 0;
            const containerHeight = knowledgeScroll.clientHeight;
            
            if (knowledgeScroll.scrollHeight - knowledgeScroll.scrollTop <= containerHeight + 50) {
                currentGroupIndex = groups.length - 1;
            } else {
                groups.forEach((group, index) => {
                    const rect = group.getBoundingClientRect();
                    // 因為是在 100vh 視窗內，我們檢查元素頂部是否在視窗上半部
                    if (rect.top < window.innerHeight * 0.6 && rect.bottom > window.innerHeight * 0.4) {
                        currentGroupIndex = index;
                    }
                });
            }

            groups.forEach((g, i) => {
                if (i === currentGroupIndex) g.classList.add('active');
                else g.classList.remove('active');
            });

            const data = contentData[currentGroupIndex];
            if (visualNum.innerText !== data.num) {
                const content = document.querySelector('.index-content');
                content.style.opacity = 0;
                content.style.transform = 'translateY(10px)';
                
                setTimeout(() => {
                    visualNum.innerText = data.num;
                    visualLabel.innerText = data.label;
                    visualTitle.innerText = data.title;
                    visualDesc.innerText = data.desc;
                    content.style.opacity = 1;
                    content.style.transform = 'translateY(0)';
                }, 300);
            }
        });
    </script>
</body>
</html>
